<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="assets/img/favicon.ico">
<title>H3hive</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">

   <style> 
        table { 
            margin: auto; 
background: #f1f1f1;
        } 

	a {
color : #4498d9;

}

    </style> 






</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">
	<img src="assets/img/logo.png" alt="logo">
	</a>
	<!-- End Logo -->
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">
			<li class="nav-item active">
			<a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="threats.html">Threats</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="reports.html">Reports</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="presentations.html">Presentations</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="https://yaraify.abuse.ch/user/45347/" target="_blank">Yara Rules</a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="about.html">About</a>
			</li>
		</ul>
		<!-- End Menu -->
		
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->

<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Begin Fixed Left Share -->
		<div class="col-md-2 col-xs-12">
			<div class="share">
				
			</div>
		</div>
		<!-- End Fixed Left Share -->

		<!-- Begin Post -->
		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				<div class="row post-top-meta">
					<div class="col-md-2">
						<a href="about.html"><img class="author-thumb-2" src="images/me.jpg"></a>
					</div>
					<div class="col-md-10">
						<a class="link-dark" href="about.html">jfarnan</a> &nbsp<span class="dot"></span>
						
						<span class="post-date">Nov 20, 2021</span>&nbsp<span class="dot"></span>&nbsp<span class="post-read">4 min read</span>
					</div>
				</div>
				<!-- End Top Menta -->

				<h1 class="posttitle">CCleaner Breach Analysis and impact</h1>

			</div>

			<div class="article-post">
			
			<p>
			CCleaner is a legitimate system clean-up software solution which fell victim to hackers, who inserted rouge code into the program’s free versions and than pushed out as an genuine update which was downloaded thousands of times.
			</p>

			<b>
			CCleaner
			</b>
			
			<p>
			CCleaner is a popular file clean-up and performance optimization utility for the windows operating system. It removes unused files, allowing windows to run faster and free up valuable hard disk space. It cleans traces of your online history and also features a registry cleaner, cleans temporary files to optimize and speed up your computer. It is available in 32bit and 64bit with the option of a free or a professional version.
			</p>

			<p>
			Avast who owns CCleaner discovered its download servers had been hacked into and malicious code had been injected to two versions of its CCleaner application installers. This allowed the legitimate signed version of CCleaner 5.33 and cloud version 1.07 installers to contain a multi-stage malware payload that rode on top of the installation of CCleaner. These versions of CCleaner were available to the general public between August 15 and September 12, 2017. Avast believes it was able to prevent the breach harming customers, and users are now safe as its investigation indicates it was able to disarm the threat before it was able to do any harm.
			</p>
			
			<b>
			Supply Chain Attack
			</b>

			<p>
			The attack on CCleaner is known as a supply-chain malware attack, it’s a cyber-attack that seeks to damage an organization by targeting less-secure elements in the supply chain of the company.
			</p>
		
			</div>



			<!-- Image -->
			<img class="featured-image img-fluid" src="ccleaner/attack.jpg" alt="">
			

			<!-- Begin Post Content -->
			<div class="article-post">
				<p>
					This type of attack is a well thought out attack, the hackers would have been monitoring the organization for a period of time, looking for weak points, and leveraging its systems to gain maximum advantage. Spyware was downloaded as well as the legitimate CCleaner application, sending back user information to the cybercriminals C&C servers. The hackers were looking for high profile targets, large tech organizations, such as Google or Microsoft, which they could steal source code, software applications, or any data they may deem useful.
				</p>
					
				<b>
				Application History
				</b>

				<p>
					 CCleaner, originally named Crap Cleaner when the small company Piriform released it in 2004. The app started life as a registry cleaner, which removed old Windows Registry entries after users have uninstalled old apps, which would improve Windows OS speed. Over the years the app evolved and now supports a trove of other features. It can remove temporary or old files left by removed apps, perform automatic updates for other apps and block ad trackers, etc. CCleaner is now owned by Czech cybersecurity firm Avast, who acquired Piriform in 2017 and had to deal with the PR fallout throughout 2017 and 2018.
				</p>

				<b>
				Malware Description
				</b>
				<p>
					CCleaner is a legitimate system clean-up software solution which fell victim to hackers who inserted rouge code into the program’s free version, sometime between March 11th and July 4th 2017. It is believed a group of Chinese state-sponsored hackers breached Piriform's network via a TeamViewer account, searched for CCleaner distribution servers, and then released a CCleaner update tainted with malware. Avast says about 2.27 million people ran the infected software.  This happened prior to Avast’s acquisition of Piriform on July 18, 
				</p>
				
				<p>
					<b>Arrival and Installation:</b> The distribution of the compromised CCleaner came from the actual website of Piriform. Hackers were able to compromise the CClenaner installer binaries hosted in the website which resulted to the distribution of the malicious software to the unsuspecting users. Since it came from a legitimate source and digitally signed, it would be almost impossible for users to identify that software has been modified to perform malicious activity. 
				</p>
			

				<!-- Image -->
				<img class="featured-image img-fluid" src="ccleaner/distribution.jpg" alt="">


				<p>
				<b>Two stage Malware:</b> The malware came in two stages, the first stage was designed to collect non-sensitive information from CCleaners users and was also used as a downloader for the second stage. The second stage was used to download a binary, only if the hackers deemed the user a high value target.
				</p>
				
				<!-- Image -->
				<img class="featured-image img-fluid" src="ccleaner/infection.jpg" alt="">

				<p>
				<b>Stage 1:</b> The malware creates a backdoor and uses a hardcoded C2 server to send information about the affected system and fetch the second payload. The first payload when executed installed a piece of spyware called Foxif. This program builds a complete picture of the infected device and a complete picture of the local network. The malware gathers information of the running processes, installed software, mac addresses and network interfaces. This information is useful for targeting vulnerable system, running outdated versions of programs containing known vulnerabilities. The payload included download capabilities for the second stage.
				</p>
				
				<p>
				<b>Stage 2:</b> The second payload was a malicious binary called Trojan.Nyetya, when dropped is automatically loaded, created a service and ran on the system. This payload includes patched legitimate software products, used to unzipping files and uninstall antivirus software. Creates a backdoor to get commands from its C&C servers, it uses a completely different control network than the first stage. Some of the user information passed to the cybercriminals is: <br> 
				* The users keystrokes <br>
				* Saved passwords used in browsers <br>
				* Financial information <br>
				* Any frequently used MS Word documents <br>
				The complex code is heavily obfuscated and uses anti-debugging tricks to conceal its inner workings. Only 40 PC’s were ever affected by this second payload, a possible reason was Hackers were looking for computers installed on the networks of one the several major tech companies, such as Google or Microsoft.
				</p>
				
				<p>
				<b>The Third stage:</b>  After further investigations of the 2017 attack, Avast found a possible third stage of the attack in 2018. This stage would install ShadowPad malware on compromised computers. ShadowPad is a cyberattack platform that cybercriminals deploy in victims networks to gain remote access capabilities. There is no evidence that this stage actually affected any computers. The possible reason this stage never took place, could be because of the fast detection and speedy clean-up of the attack by Avast.
				<br><br>
				In 2019 several attempts by Hackers to gain access to CCleaner servers once again, this time compromising its main internal network in the process and yet again, seeking to tamper with CCleaner releases. A product by a security vender is the last place people will expect to find comprised software, we expect such companies to maintain and have security check on their own products. Accidents like this demonstrate that no one, not even a security vendor can escape such attacks. 
				<br><br>
				For a more detailed and technical analysis on this attack I created a <b> CCleander Hack: Reversing Engineering Report </b>. Available here.
				<br><br>
				</p>

			</div>
			<!-- End Post Content -->




			<!-- Begin Table -->

 			<table border="0"> 

		         <tr> 
         		 <td><img src= "reports/covers/ccleaner.jpg"  width="100"  height="130"> <a href="reports/CCleaner.pdf" target="_blank"  style="margin:11px;">Read More</a> </td> 
    
          		 <td><h4> CCLEANER HACK: REVERSE ENGINEERING REPORT </h4>This report is a deep dive into the CCleaner Hack looking at the technical aspects of the attack and how it was accomplished. Reverse Engineering the installer I can show each step of the attack process, while also showing examples of how it was done. This is a very complex attack involving many stages. The objective of this report is to make this more understandable while benefitting other Malware Researchers.<br><br></td> 
        
       			 </tr> 


  			</table> 

			<!-- End Table -->
		<br><br>






		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

<div class="hideshare"></div>

<!-- Begin Related
================================================== -->
<div class="graybg">
	<div class="container"><h4>Recent Posts</h4><br>
		<div class="row listrecent listrelated">

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="patching.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/patching.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="patching.html">Patching Executables - An Introduction</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="debugging.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/debugging.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="debugging.html">Debuggion C++ Classes using the X64dbg Debugger</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="reversing.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/reversing.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="reversing.html">Reversing a simple C++ program</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

		</div>
	</div>
</div>
<!-- End Related Posts
================================================== -->



<!-- Begin Footer
================================================== -->
<div class="container">
	<div class="footer">
		<p class="pull-left">
			 Copyright &copy; 2024 H3hive
		</p>
	
		<div class="clearfix">
		</div>
	</div>
</div>
<!-- End Footer
================================================== -->



<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
