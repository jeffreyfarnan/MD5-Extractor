<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="assets/img/favicon.ico">
<title>H3hive</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">
</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">
	<img src="assets/img/logo.png" alt="logo">
	</a>
	<!-- End Logo -->
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">
			<li class="nav-item active">
			<a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="threats.html">Threats</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="reports.html">Reports</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="presentations.html">Presentations</a>
			</li>
                        <li class="nav-item">
			<a class="nav-link" href="https://yaraify.abuse.ch/user/45347/" target="_blank">Yara Rules</a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="about.html">About</a>
			</li>
		</ul>
		<!-- End Menu -->
	
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->

<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Begin Fixed Left Share -->
		<div class="col-md-2 col-xs-12">
			<div class="share">
				
			</div>
		</div>
		<!-- End Fixed Left Share -->

		<!-- Begin Post -->
		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				<div class="row post-top-meta">
					<div class="col-md-2">
						<a href="about.html"><img class="author-thumb-2" src="images/me.jpg"></a>
					</div>
					<div class="col-md-10">
						<a class="link-dark" href="about.html">jfarnan</a> &nbsp<span class="dot"></span>
						
						<span class="post-date">Jul 16, 2021</span>&nbsp<span class="dot"></span>&nbsp<span class="post-read">2 min read</span>
					</div>
				</div>
				<!-- End Top Menta -->
				
					<h1 class="posttitle">Analysis of how a Buffer Overflow is created</h1>

			

			</div>

			<div class="article-post">
			<p>
			A simple C program was created to demonstrate a basic overflow example. Two buffers and a variable are created, filled normally and then overwritten with the contents of the argument pushed to them.
				</p>		
			
		        <b>
			The Source Code
			</b>
   				
			 <p>
			A int variable is created with the value of 5, two char buffers also were created, with a size of 8 bytes each. Using the String Copy API (Strcpy) the strings “one”  and “two” were placed into buffer one and two. 
			</p>

			</div>



			<!-- Image -->
			<img class="featured-image img-fluid" src="overflow/code.jpg" alt="">
			

			<!-- Begin Post Content -->
			<div class="article-post">
				<p>
					I created printf statements to show the before and after contents of these buffers plus the int variable.
				</p>
					<!-- Image -->
					<img class="featured-image img-fluid" src="overflow/before.jpg" alt="">

   			 <b>
			Debugging using IDA PRO
			</b>

	 		<p>
			The goal is to overwrite these buffers with the contents I give them. We step through the program line by line using Ida Pro debugger. In Ida pro you can add parameters while being debugged, go to Debugger -> Process Options and fill in the Parameters field, in my case I filled it with a line of ‘a’s. 
			</p>

					<!-- Image -->
					<img class="featured-image img-fluid" src="overflow/setArgs.jpg" alt="">
   			 <p>
			The second stage is now to replace the contents of these buffers and variable with ‘a’s. Only one buffer needs to be overwritten, when that is filled the ‘a’s will overlap into the second buffer, when that is filled it will replace the content of the variable with ‘a’s also.
			</p>
					<!-- Image -->
					<img class="featured-image img-fluid" src="overflow/overflow.jpg" alt="">
					<b>Before</b> (buffer_two holds the letters "two") and  <b>After</b> (buffer_two is now filled with a’s)
	 		<p>
			
			</p>
			
			 <p>
			As we can see in the assembly the contents of the buffers are being overwritten with the contents of the parameters. Buffer_two is filled with ‘a’s  than overlaps into buffer_one and overlapping into the int variable. When the program is completed we can see the ‘a’s” have overwritten each buffer plus the variable. The final printout shows the following:
			</p>
					<!-- Image -->
					<img class="featured-image img-fluid" src="overflow/output.jpg" alt="">
	 


			</div>
			<!-- End Post Content -->



		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

<div class="hideshare"></div>

<!-- Begin Related
================================================== -->
<div class="graybg">
	<div class="container"><h4>Recent Posts</h4><br>
		<div class="row listrecent listrelated">

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="alerts.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/alert.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="alerts.html">Reversing a Fake Alert with Ghidra</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="shellcode.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/shellcode.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="shellcode.html">Reversing Shellcode into a working C program</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

			<!-- begin post -->
			<div class="col-md-4">
				<div class="card">
					<a href="downloader.html">
					<img class="img-fluid img-thumb" src="assets/img/cover/downloader.jpg" alt="">
					</a>
					<div class="card-block">
						<h2 class="card-title"><a href="downloader.html">Reverse a C++ basic downloader</a></h2>
						
					</div>
				</div>
			</div>
			<!-- end post -->

		</div>
	</div>
</div>
<!-- End Related Posts
================================================== -->



<!-- Begin Footer
================================================== -->
<div class="container">
	<div class="footer">
		<p class="pull-left">
			 Copyright &copy; 2024 H3hive
		</p>
		
		<div class="clearfix">
		</div>
	</div>
</div>
<!-- End Footer
================================================== -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
